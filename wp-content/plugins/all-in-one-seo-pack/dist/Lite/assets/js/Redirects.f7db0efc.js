var N=Object.defineProperty,M=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var f=(e,s,t)=>s in e?N(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,n=(e,s)=>{for(var t in s||(s={}))B.call(s,t)&&f(e,t,s[t]);if(v)for(var t of v(s))q.call(s,t)&&f(e,t,s[t]);return e},c=(e,s)=>M(e,F(s));import{d,j as h}from"./index.0f8634bc.js";import{C as p,h as A,d as g}from"./index.02c35f2a.js";import"./ToolsSettings.4a14c135.js";import{J as j}from"./JsonValues.08065e69.js";import{n as o}from"./vueComponentNormalizer.87056a83.js";import{C as H}from"./ProBadge.7c0de2f7.js";import{S as V}from"./External.8868c638.js";import{S as x}from"./Close.5e7bcb70.js";import{S as L}from"./Exclamation.356738ce.js";import{B as z}from"./Checkbox.5873a8d2.js";import{C as _}from"./Index.6d59ffe7.js";import{G as W,a as Y}from"./Row.13b6f3f1.js";import{S as G}from"./Gear.c974e953.js";import{S as D}from"./Trash.214b5744.js";import{T as m}from"./Slide.f5d21606.js";import{C as P}from"./Tooltip.674a9fb4.js";import{S as Q}from"./Plus.a9b9ba75.js";import{C as J}from"./Blur.8490ecd2.js";import{C as K}from"./Card.5e3c0ad5.js";import{C as Z}from"./Index.92c3733f.js";var X=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-wp-additional-filters alignleft actions"},[e._l(e.additionalFilters,function(r,a){return[t("label",{key:a+"_label",staticClass:"screen-reader-text",attrs:{for:"filter-by-date"}},[e._v(e._s(r.label))]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedFilters[r.name],expression:"selectedFilters[filter.name]"}],key:a+"_select",attrs:{name:r.name},on:{change:[function(i){var l=Array.prototype.filter.call(i.target.options,function(u){return u.selected}).map(function(u){var I="_value"in u?u._value:u.value;return I});e.$set(e.selectedFilters,r.name,i.target.multiple?l:l[0])},function(i){return e.$emit("change",{name:r.name,selectedValue:i.target.value})}]}},e._l(r.options,function(i,l){return t("option",{key:l,domProps:{value:i.value}},[e._v(" "+e._s(i.label)+" ")])}),0)]}),t("input",{staticClass:"button action",attrs:{type:"submit"},domProps:{value:e.strings.filter},on:{click:function(r){return e.$emit("process-additional-filters",e.selectedFilters)}}})],2)},ee=[];const te={props:{additionalFilters:{type:Array,required:!0}},data(){return{strings:{filter:"Filter"}}},computed:n({},d("redirects",["selectedFilters"])),mounted(){this.setInitialOptions()},updated(){this.setInitialOptions()},methods:{setInitialOptions(){this.additionalFilters.forEach(e=>{this.selectedFilters[e.name]||this.$set(this.selectedFilters,e.name,e.options[0].value)})}}},b={};var se=o(te,X,ee,!1,re,null,null,null);function re(e){for(let s in b)this[s]=b[s]}var ae=function(){return se.exports}(),ie=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-wp-bulk-actions alignleft actions bulkactions"},[t("select",{directives:[{name:"model",rawName:"v-model",value:e.bulkAction,expression:"bulkAction"}],attrs:{name:"action"},on:{change:function(r){var a=Array.prototype.filter.call(r.target.options,function(i){return i.selected}).map(function(i){var l="_value"in i?i._value:i.value;return l});e.bulkAction=r.target.multiple?a:a[0]}}},[t("option",{attrs:{value:"-1"}},[e._v(e._s(e.strings.bulkActions))]),e._l(e.bulkOptions,function(r,a){return t("option",{key:a,domProps:{value:r.value}},[e._v(e._s(r.label))])})],2),t("input",{staticClass:"button action",attrs:{type:"submit"},domProps:{value:e.strings.apply},on:{click:function(r){e.bulkAction!=="-1"&&e.$emit("process-bulk-action",e.bulkAction)}}})])},le=[];const ne={props:{bulkOptions:{type:Array,required:!0}},data(){return{bulkAction:"-1",strings:{bulkActions:"Bulk Actions",apply:"Apply"}}}},y={};var oe=o(ne,ie,le,!1,ue,null,null,null);function ue(e){for(let s in y)this[s]=y[s]}var ce=function(){return oe.exports}(),de=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-wp-table"},[e.showHeader?t("div",{staticClass:"header"},[t("ul",{staticClass:"subsubsub"},e._l(e.filters,function(r,a){return t("li",{key:a,class:r.slug},[t("span",{staticClass:"name",class:{active:r.active}},[r.active?e._e():t("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),e.processFilter(r)}}},[e._v(" "+e._s(r.name)+" "),t("span",[e._v("("+e._s(e.$numbers.numberFormat(r.count))+")")])]),r.active?[e._v(" "+e._s(r.name)+" "),t("span",[e._v("("+e._s(e.$numbers.numberFormat(r.count))+")")])]:e._e()],2),a+1<e.filters.length?t("span",{staticClass:"separator"},[e._v("|")]):e._e()])}),0),e.showSearch?t("p",{staticClass:"search-box"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.searchTerm,expression:"searchTerm"}],attrs:{type:"search",id:"post-search-input",name:"s"},domProps:{value:e.searchTerm},on:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.$emit("search",e.searchTerm)},input:function(r){r.target.composing||(e.searchTerm=r.target.value)}}}),t("input",{staticClass:"button",attrs:{type:"submit",id:"search-submit"},domProps:{value:e.searchLabel},on:{click:function(r){return r.preventDefault(),e.$emit("search",e.searchTerm)}}})]):e._e(),t("div",{staticClass:"tablenav top"},[e.showBulkActions&&e.bulkOptions&&e.bulkOptions.length?t("core-wp-bulk-actions",{attrs:{"bulk-options":e.bulkOptions},on:{"process-bulk-action":e.processBulkAction}}):e._e(),e.additionalFilters&&e.additionalFilters.length?t("core-wp-additional-filters",{attrs:{"additional-filters":e.additionalFilters},on:{change:function(r){return e.$emit("additional-filter-option-selected",r)},"process-additional-filters":e.processAdditionalFilters}}):e._e(),e.showPagination?t("div",{staticClass:"tablenav-pages pagination"},[t("span",{staticClass:"displaying-num"},[e._v(e._s(e.$numbers.numberFormat(e.totals.total))+" "+e._s(e.strings.items))]),t("span",{staticClass:"pagination-links"},[t(e.pageNumber===1?"span":"a",{tag:"component",class:e.pageNumber===1?"tablenav-pages-navspan button disabled":"first-page button",attrs:{href:"#"},on:{click:function(r){r.preventDefault(),e.pageNumber===1||e.toPage(1)}}},[e._v(" \xAB ")]),t(e.pageNumber===1?"span":"a",{tag:"component",class:e.pageNumber===1?"tablenav-pages-navspan button disabled":"prev-page button",attrs:{href:"#"},on:{click:function(r){r.preventDefault(),e.pageNumber===1||e.toPage(e.pageNumber-1)}}},[e._v("\u2039")]),t("span",{staticClass:"paging-input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.pageNumber,expression:"pageNumber"}],staticClass:"current-page",attrs:{type:"number",name:"paged",size:"2",min:1,max:e.totals.pages,step:1,"aria-describedby":"table-paging",disabled:!e.totals.pages},domProps:{value:e.pageNumber},on:{keyup:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.toPage(e.pageNumber)},input:function(r){r.target.composing||(e.pageNumber=r.target.value)}}}),t("span",{staticClass:"tablenav-paging-text"},[e._v(" "+e._s(e.strings.of)+" "+e._s(e.totals.pages)+" ")])]),t(e.pageNumber===e.totals.pages||!e.totals.pages?"span":"a",{tag:"component",class:e.pageNumber===e.totals.pages||!e.totals.pages?"tablenav-pages-navspan button disabled":"next-page button",attrs:{href:"#"},on:{click:function(r){r.preventDefault(),e.pageNumber===e.totals.pages||!e.totals.pages||e.toPage(e.pageNumber+1)}}},[e._v(" \u203A ")]),t(e.pageNumber===e.totals.pages||!e.totals.pages?"span":"a",{tag:"component",class:e.pageNumber===e.totals.pages||!e.totals.pages?"tablenav-pages-navspan button disabled":"last-page button",attrs:{href:"#"},on:{click:function(r){r.preventDefault(),e.pageNumber===e.totals.pages||!e.totals.pages||e.toPage(e.totals.pages)}}},[e._v(" \xBB ")])],1)]):e._e(),t("br",{staticClass:"clear"})],1)]):e._e(),t("div",{staticClass:"wp-table"},[t("table",{ref:"table",staticClass:"wp-list-table widefat fixed",attrs:{cellpadding:"0",cellspacing:"0"}},[t("thead",[t("tr",[e.showBulkActions?t("td",{staticClass:"manage-column column-cb check-column"},[t("input",{attrs:{type:"checkbox",disabled:e.loading}})]):e._e(),e._l(e.columns,function(r,a){return t("th",{key:a,staticClass:"manage-column",class:[{sortable:r.sortable,asc:r.sortDir==="asc"&&r.sortable,desc:r.sortDir==="desc"&&r.sortable,sorted:r.sortable&&r.sorted},r.slug],style:{width:r.width},attrs:{scope:"col"}},[!r.tooltipIcon&&r.sortable?[t("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),function(l){return e.$emit("sort-column",r,l)}.apply(null,arguments)}}},[t("span",[e._v(e._s(r.label))]),t("span",{staticClass:"sorting-indicator"})])]:e._e(),!r.tooltipIcon&&!r.sortable?[e._v(" "+e._s(r.label)+" ")]:e._e(),r.tooltipIcon?[t("div",{staticClass:"aioseo-table-header-tooltip-icon"},[t("core-tooltip",{staticClass:"action",attrs:{type:"action"},scopedSlots:e._u([{key:"tooltip",fn:function(){return[e._v(" "+e._s(r.label)+" ")]},proxy:!0}],null,!0)},[t(r.tooltipIcon,{tag:"component"})],1)],1)]:e._e()],2)})],2)]),e.rows?t("tbody",{attrs:{id:"the-list"}},[e.loading?t("div",{staticClass:"loader-overlay"},[t("core-loader")],1):e._e(),e._l(e.rows,function(r,a){return[t("tr",{key:a+"_"+r.id,staticClass:"main-row",class:{even:a%2===0,enabled:r.enabled||!r.hasOwnProperty("enabled")},attrs:{"data-row-id":r.id||a}},[e.showBulkActions?t("th",{staticClass:"check-column",attrs:{scope:"row"}},[t("input",{attrs:{type:"checkbox"}})]):e._e(),e._l(e.columns,function(i,l){return t("td",{key:l},[e.$scopedSlots[i.slug]?[e._t(i.slug,null,{row:r,column:r[i.slug],editRow:e.editRow,index:a,editRowActive:e.activeRow===a})]:e._e(),e.$scopedSlots[i.slug]?e._e():t("span",[e._v(" "+e._s(r[i.slug])+" ")])],2)})],2),t("tr",{key:a+"_edit",staticClass:"edit-row",class:{even:a%2===0}},[t("td",{staticClass:"edit-row-content",attrs:{colspan:e.showBulkActions?e.columns.length+1:e.columns.length}},[t("transition-slide",{staticClass:"wrapper",attrs:{tag:"div",active:a===e.activeRow}},[t("div",{staticClass:"border"},[e._t("edit-row",null,{row:r,index:a,editRow:e.editRow})],2)])],1)])]}),e.rows.length?e._e():[t("td",{attrs:{colspan:e.columns.length+1}},[t("div",{staticClass:"no-results"},[e.loading?e._e():t("span",[e._v(e._s(e.strings.noResults))])])])]],2):e._e(),e.showTableFooter?t("tfoot",[t("tr",[e.showBulkActions?t("td",{staticClass:"manage-column column-cb check-column"},[t("input",{attrs:{type:"checkbox",disabled:e.loading}})]):e._e(),e._l(e.columns,function(r,a){return t("th",{key:a,staticClass:"manage-column",style:{width:r.width},attrs:{scope:"col"}},[e._v(" "+e._s(r.label)+" ")])})],2)]):e._e()])]),e.showTableFooter?t("div",{staticClass:"tablenav bottom"},[e.showBulkActions&&e.bulkOptions&&e.bulkOptions.length?t("core-wp-bulk-actions",{attrs:{"bulk-options":e.bulkOptions},on:{"process-bulk-action":e.processBulkAction}}):e._e(),t("div",{staticClass:"alignleft actions"}),e.showPagination?t("div",{staticClass:"tablenav-pages"},[t("span",{staticClass:"displaying-num"},[e._v(e._s(e.totals.total)+" "+e._s(e.strings.items))])]):e._e(),t("br",{staticClass:"clear"})],1):e._e()])},he=[];const pe={components:{CoreLoader:p,CoreTooltip:P,CoreWpAdditionalFilters:ae,CoreWpBulkActions:ce,TransitionSlide:m},props:{columns:{type:Array,required:!0},rows:{type:Array,required:!0},filters:{type:Array,required:!1},totals:{type:Object,required:!1},loading:Boolean,showSearch:{type:Boolean,default(){return!0}},showBulkActions:{type:Boolean,default(){return!0}},showPagination:{type:Boolean,default(){return!0}},showTableFooter:{type:Boolean,default(){return!0}},showHeader:{type:Boolean,default(){return!0}},searchLabel:{type:String,default(){return"Search"}},initialPageNumber:{type:Number,default(){return 1}},initialSearchTerm:{type:String,default(){return""}},bulkOptions:Array,additionalFilters:Array},data(){return{searchTerm:"",pageNumber:1,activeRow:null,strings:{of:"of",items:"items",noResults:"No items found."}}},watch:{pageNumber(e){if(Math.abs(e)!==e){this.pageNumber=Math.floor(e);return}if(this.totals&&e>this.totals.pages){this.pageNumber=this.totals.pages;return}1>e&&(this.pageNumber=1)}},methods:{editRow(e){if(e===null||this.activeRow===e){this.activeRow=null;return}this.activeRow=e},processBulkAction(e){this.$emit("process-bulk-action",{action:e,selectedRows:this.selectedItems()}),this.resetSelectedItems()},processFilter(e){this.pageNumber=1,this.searchTerm="",this.$emit("filter-table",e)},processAdditionalFilters(e){this.pageNumber=1,this.searchTerm="",this.$emit("process-additional-filters",{filters:e})},selectedItems(){const e=this.$refs.table.querySelectorAll("tbody tr.main-row"),s=[];return e.forEach(t=>{t.querySelector("th.check-column input").checked&&s.push(t.dataset.rowId)}),s},resetSelectedItems(){const e=this.$refs.table.querySelectorAll(".check-column input:checked");e&&e.forEach(s=>s.checked=!1)},toPage(e){this.pageNumber=e,this.$emit("paginate",e,this.searchTerm)},setPageNumber(e){this.pageNumber=e}},mounted(){this.pageNumber=this.initialPageNumber,this.searchTerm=this.initialSearchTerm}},R={};var ge=o(pe,de,he,!1,_e,null,null,null);function _e(e){for(let s in R)this[s]=R[s]}var me=function(){return ge.exports}(),ve=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-add-redirection-url-results"},[t("ul",e._l(e.results,function(r,a){return t("li",{key:a,on:{click:function(i){return e.$emit("set-url",r.link)}}},[t("span",[t("div",{staticClass:"option"},[t("div",{staticClass:"option-title"},[t("div",{domProps:{innerHTML:e._s(e.getOptionTitle(r.label))}}),r.status!=="publish"?t("core-pro-badge",[e._v(" "+e._s(e.getStatusLabel(r.status))+" ")]):e._e()],1),t("div",{staticClass:"option-details"},[t("span",[e._v(e._s(r.link))])])]),t("a",{staticClass:"option-permalink",attrs:{href:r.link,target:"_blank"},on:{click:function(i){return i.stopPropagation(),function(){}.apply(null,arguments)}}},[t("svg-external")],1)])])}),0)])},fe=[];const be={components:{CoreProBadge:H,SvgExternal:V},props:{results:{type:Array,required:!0},url:String},data(){return{strings:{DRAFT:"DRAFT",PENDING:"PENDING",FUTURE:"FUTURE"}}},methods:{getOptionTitle(e){const s=new RegExp(`(${this.url})`,"gi");return e.replace(s,'<span class="search-term">$1</span>')},getStatusLabel(e){switch(e.toLowerCase()){case"draft":return this.strings.DRAFT;case"future":return this.strings.FUTURE;case"pending":return this.strings.PENDING}}}},C={};var ye=o(be,ve,fe,!1,Re,null,null,null);function Re(e){for(let s in C)this[s]=C[s]}var O=function(){return ye.exports}(),Ce=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{ref:"redirect-target-url",staticClass:"aioseo-add-redirection-target-url"},[t("base-input",{class:{"aioseo-error":e.errors.length,"aioseo-active":!e.errors.length&&!e.warnings.length&&e.url,"aioseo-warning":e.warnings.length},attrs:{size:"medium",placeholder:"/target-page/"},on:{keyup:e.searchChange,focus:function(r){e.showResults=!0},input:function(r){return e.$emit("input",e.value)},blur:function(r){return e.$emit("blur",e.value)}},scopedSlots:e._u([{key:"append-icon",fn:function(){return[t("div",{staticClass:"append-icon"},[e.isLoading?e._e():[e.errors.length?t("svg-circle-close"):e._e(),!e.errors.length&&!e.warnings.length&&e.url?t("svg-circle-check"):e._e(),e.warnings.length?t("svg-circle-exclamation"):e._e()],e.isLoading?t("core-loader",{attrs:{dark:""}}):e._e()],2)]},proxy:!0}]),model:{value:e.value,callback:function(r){e.value=r},expression:"value"}}),e.showResults&&e.results.length?t("core-add-redirection-url-results",{attrs:{results:e.results,url:e.value},on:{"set-url":e.setUrl}}):e._e()],1)},$e=[];const Se={components:{CoreAddRedirectionUrlResults:O,CoreLoader:p,SvgCircleCheck:A,SvgCircleClose:x,SvgCircleExclamation:L},props:{url:String,errors:Array,warnings:Array},data(){return{showResults:!1,isLoading:!1,value:null,results:[]}},watch:{value(){this.value&&(this.value=this.value.replace(/(https?:\/)(\/)+|(\/)+/g,"$1$2$3"))},url:{immediate:!0,handler(){this.value=this.url}}},computed:n({},d(["currentPost"])),methods:c(n({},h("redirects",["getPosts"])),{onBlur(){setTimeout(()=>{this.$emit("input",this.value)},150)},searchChange(){if(!!this.value){if(this.value.startsWith("/")||this.value.startsWith("http:")||this.value.startsWith("https:")){this.isLoading=!1;return}this.isLoading=!0,g(()=>{if(!this.value){this.isLoading=!1;return}this.showResults=!0,this.ajaxSearch(this.value).then(()=>this.isLoading=!1)},500)}},ajaxSearch(e){return this.getPosts({query:e,postId:this.currentPost.id}).then(s=>{this.results=s.body.objects})},setUrl(e){this.showResults=!1,this.value=e.replace(this.$aioseo.urls.mainSiteUrl,"",e),this.$emit("input",this.value)},documentClick(e){if(!this.showResults)return;const s=e&&e.target?e.target:null,t=this.$refs["redirect-target-url"];t&&t!==s&&!t.contains(s)&&(this.showResults=!1)}}),mounted(){document.addEventListener("click",this.documentClick)},beforeDestroy(){document.removeEventListener("click",this.documentClick)}},$={};var Ue=o(Se,Ce,$e,!1,ke,null,null,null);function ke(e){for(let s in $)this[s]=$[s]}var Te=function(){return Ue.exports}(),Ee=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{ref:"redirect-source-url",staticClass:"aioseo-redirect-source-url"},[t("base-input",{class:{"aioseo-error":e.url.errors.length,"aioseo-active":!e.url.errors.length&&!e.url.warnings.length&&e.url.url,"aioseo-warning":e.url.warnings.length},attrs:{value:e.url.url,disabled:e.log404||e.disableSource,size:"medium",placeholder:"/source-page/"},on:{input:function(r){return e.updateSourceUrl(r)},keyup:e.searchChange,focus:function(r){e.showResults=!0}},scopedSlots:e._u([{key:"append-icon",fn:function(){return[t("div",{staticClass:"append-icon"},[e.isLoading?e._e():[e.url.errors.length?t("svg-circle-close"):e._e(),!e.url.errors.length&&!e.url.warnings.length&&e.url.url?t("svg-circle-check"):e._e(),e.url.warnings.length?t("svg-circle-exclamation"):e._e(),t("svg-gear",{class:{active:e.urlOptionsActive},nativeOn:{click:function(r){e.showOptions=!e.showOptions}}}),e.allowDelete?t("svg-trash",{nativeOn:{click:function(r){return e.$emit("remove-url")}}}):e._e()],e.isLoading?t("core-loader",{attrs:{dark:""}}):e._e()],2)]},proxy:!0}])}),!e.url.regex&&e.showResults&&e.results.length?t("core-add-redirection-url-results",{attrs:{results:e.results,url:e.url.url},on:{"set-url":e.setUrl}}):e._e(),e.log404?e._e():e._t("source-url-description"),t("transition-slide",{staticClass:"source-url-options",attrs:{active:e.showOptions}},[t("div",[t("grid-row",[t("grid-column",{attrs:{xs:"4"}},[t("base-checkbox",{attrs:{size:"medium",value:e.url.ignoreSlash},on:{input:function(r){return e.updateOption("ignoreSlash",r)}}},[e._v(" "+e._s(e.strings.ignoreSlash)+" ")])],1),t("grid-column",{attrs:{xs:"4"}},[t("base-checkbox",{attrs:{size:"medium",value:e.url.ignoreCase},on:{input:function(r){return e.updateOption("ignoreCase",r)}}},[e._v(" "+e._s(e.strings.ignoreCase)+" ")])],1),!e.log404&&!e.disableSource?t("grid-column",{attrs:{xs:"4"}},[t("base-checkbox",{attrs:{size:"medium",value:e.url.regex},on:{input:function(r){return e.updateOption("regex",r)}}},[e._v(" "+e._s(e.strings.regex)+" ")])],1):e._e()],1)],1)]),t("transition-slide",{attrs:{active:!!e.url.errors.length}},e._l(e.url.errors,function(r,a){return t("core-alert",{key:a,staticClass:"source-url-error",attrs:{type:"red",size:"small"},domProps:{innerHTML:e._s(r)}})}),1),t("transition-slide",{attrs:{active:!!e.url.warnings.length}},e._l(e.url.warnings,function(r,a){return t("core-alert",{key:a,staticClass:"source-url-warning",attrs:{type:"yellow",size:"small"},domProps:{innerHTML:e._s(r)}})}),1)],2)},we=[];const Ae={components:{BaseCheckbox:z,CoreAddRedirectionUrlResults:O,CoreAlert:_,CoreLoader:p,GridColumn:W,GridRow:Y,SvgCircleCheck:A,SvgCircleClose:x,SvgCircleExclamation:L,SvgGear:G,SvgTrash:D,TransitionSlide:m},props:{url:{type:Object,default(){return{id:null,url:null,regex:!1,ignoreSlash:!0,ignoreCase:!0,errors:[],warnings:[]}}},allowDelete:Boolean,targetUrl:String,log404:Boolean,disableSource:Boolean},data(){return{showResults:!1,isLoading:!1,showOptions:!1,strings:{ignoreSlash:"Ignore Slash",ignoreCase:"Ignore Case",regex:"Regex"},results:[]}},watch:{targetUrl(){this.updateSourceUrl(this.url.url)}},computed:{maybeRegex(){return this.url.url.match(/[*\\()[\]^$]/)!==null||this.url.url.indexOf(".?")!==-1},invalidUrl(){if(!this.url.url)return!1;const e=[];if(this.url.regex)try{new RegExp(this.url.url)}catch{return e.push("The regex syntax is invalid."),e}if(this.url.url.substr(0,4)==="http"&&this.url.url.indexOf(document.location.origin)===-1&&e.push("Please enter a valid relative source URL."),this.url.url.match(/%\w+%/)&&e.push("Permalinks are not currently supported."),(this.url.url==="/(.*)"||this.url.url==="^/(.*)")&&e.push("This redirect is supported using the Relocate Site feature under Full Site Redirect tab."),this.url.url&&this.url.url.length&&this.targetUrl&&this.targetUrl.length){let s=this.url.ignoreSlash?this.$links.unTrailingSlashIt(this.url.url):this.url.url,t=this.url.ignoreSlash?this.$links.unTrailingSlashIt(this.targetUrl):this.targetUrl;s=this.url.ignoreCase?s.toLowerCase():s,t=this.url.ignoreCase?t.toLowerCase():t,(s===t||this.url.regex&&t.match(s))&&e.push("Your source is the same as a target and this will create a loop.")}return e},iffyUrl(){if(!this.url.url)return[];const e=[];return this.url.url.substr(0,4)!=="http"&&this.url.url.substr(0,1)!=="/"&&0<this.url.url.length&&!this.url.regex&&e.push(this.$t.sprintf("The source URL should probably start with a %1$s","<code>/</code>")),this.url.url.indexOf("#")!==-1&&e.push("Anchor values are not sent to the server and cannot be redirected."),!this.log404&&this.maybeRegex&&!this.url.regex&&e.push(this.$t.sprintf("Remember to enable the %1$s option if this is a regular expression.","<code>Regex</code>")),this.url.regex&&(this.url.url.indexOf("^")===-1&&this.url.url.indexOf("$")===-1&&e.push(this.$t.sprintf("To prevent a greedy regular expression you can use %1$s to anchor it to the start of the URL. For example: %2$s","<code>^/</code>","<code>^/"+this.url.url.replace(/^\//,"")+"</code>")),0<this.url.url.indexOf("^")&&e.push(this.$t.sprintf("The caret %1$s should be at the start. For example: %2$s","<code>^/</code>","<code>^/"+this.url.url.replace("^","").replace(/^\//,"")+"</code>")),this.url.url.indexOf("^")===0&&this.url.url.indexOf("^/")===-1&&e.push(this.$t.sprintf("The source URL should probably start with a %1$s","<code>^/</code>")),this.url.url.length-1!==this.url.url.indexOf("$")&&this.url.url.indexOf("$")!==-1&&e.push(this.$t.sprintf("The dollar symbol %1$s should be at the end. For example: %2$s","<code>$</code>","<code>"+this.url.url.replace(/\$/g,"")+"$</code>"))),this.url.url.match(/(\.html|\.htm|\.php|\.pdf|\.jpg)$/)!==null&&e.push("Some servers may be configured to serve file resources directly, preventing a redirect occurring."),e},urlOptionsActive(){return this.url.regex||this.showOptions}},methods:c(n({},h("redirects",["getPosts"])),{updateSourceUrl(e){e&&(e=e.replace(/(https?:\/)(\/)+|(\/)+/g,"$1$2$3")),this.$set(this.url,"url",e),this.$set(this.url,"errors",this.invalidUrl),this.$set(this.url,"warnings",this.iffyUrl),this.$emit("updated-url",this.url)},updateOption(e,s){this.$set(this.url,e,s),this.updateSourceUrl(this.url.url),this.$emit("updated-option",this.url)},searchChange(){if(!(!this.url.url||this.url.regex)){if(this.url.url.startsWith("/")||this.url.url.startsWith("^")||this.url.url.startsWith("http:")||this.url.url.startsWith("https:")){this.isLoading=!1;return}this.isLoading=!0,g(()=>{if(!this.url.url){this.isLoading=!1;return}this.showResults=!0,this.ajaxSearch(this.url.url).then(()=>this.isLoading=!1)},500)}},ajaxSearch(e){return this.getPosts({query:e}).then(s=>{this.results=s.body.objects})},setUrl(e){this.showResults=!1,this.updateOption("url",e.replace(this.$aioseo.urls.mainSiteUrl,"",e))},documentClick(e){if(!this.showResults)return;const s=e&&e.target?e.target:null,t=this.$refs["redirect-source-url"];t&&t!==s&&!t.contains(s)&&(this.showResults=!1)}}),mounted(){this.url.showOptions&&(this.showOptions=!0,this.updateSourceUrl(this.url.url)),document.addEventListener("click",this.documentClick)},beforeDestroy(){document.removeEventListener("click",this.documentClick)}},S={};var xe=o(Ae,Ee,we,!1,Le,null,null,null);function Le(e){for(let s in S)this[s]=S[s]}var De=function(){return xe.exports}(),Pe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"custom-rules"},[t("table",{staticClass:"redirects-options-table",attrs:{cellspacing:"0",cellpadding:"0"}},[t("thead",[t("tr",[t("td",{attrs:{colspan:"2"}},[e._v(e._s(e.strings.customRules))])])]),t("tbody",e._l(e.customRules,function(r,a){return t("tr",{key:a,staticClass:"rule",class:{even:a%2===0}},[t("td",{staticClass:"rule-settings"},[t("base-select",{attrs:{options:e.filteredTypes,size:"medium",placeholder:e.strings.selectMatchRule,value:e.getRuleValue("type",a)},on:{input:function(i){return e.updateRule("type",i,a)}}}),e.getType(a,"options")||e.getType(a,"taggable")?t("base-select",{attrs:{options:e.getType(a,"options")||[],size:"medium",value:e.getRuleValue("value",a),multiple:e.getType(a,"multiple")||e.getType(a,"taggable"),taggable:e.getType(a,"taggable"),placeholder:e.getType(a,"placeholder")||e.strings.selectAValue},on:{input:function(i){return e.updateRule("value",i,a)}}}):e._e(),e.getType(a,"keyValuePair")?t("base-input",{attrs:{value:e.getRuleValue("key",a),size:"medium",placeholder:e.getType(a,"placeholderKey")||e.strings.key},on:{input:function(i){return e.updateRule("key",i,a)}}}):e._e(),!e.getType(a,"options")&&!e.getType(a,"taggable")?t("base-input",{attrs:{value:e.getRuleValue("value",a),size:"medium",placeholder:e.getType(a,"placeholder")||e.strings.value,disabled:!e.getType(a)},on:{input:function(i){return e.updateRule("value",i,a)}}}):e._e(),e.getType(a,"regex")?t("base-toggle",{attrs:{value:e.getRuleValue("regex",a)},on:{input:function(i){return e.updateRule("regex",i,a)}}},[e._v(" "+e._s(e.strings.regex)+" ")]):e._e()],1),t("td",{staticClass:"actions"},[t("core-tooltip",{staticClass:"action",attrs:{type:"action"},scopedSlots:e._u([{key:"tooltip",fn:function(){return[e._v(" "+e._s(e.strings.delete)+" ")]},proxy:!0}],null,!0)},[t("svg-trash",{nativeOn:{click:function(i){return e.removeRule(a)}}})],1)],1)])}),0),t("tfoot",[t("tr",[t("td",{attrs:{colspan:"2"}},[t("base-button",{attrs:{size:"small-table",type:"black"},on:{click:function(r){return e.addRule(null)}}},[t("svg-circle-plus"),e._v(" "+e._s(e.strings.add)+" ")],1)],1)])])])])},Oe=[];const Ie={type:null,key:null,value:null,regex:null},Ne={components:{CoreTooltip:P,SvgCirclePlus:Q,SvgTrash:D},props:{editCustomRules:Array},data(){return{strings:{customRules:"Custom Rules",selectMatchRule:"Select Rule",delete:"Delete",add:"Add Custom Rule",regex:"Regex",selectAValue:"Select a Value or Add a New One",key:"Key",value:"Value"},customRules:[],types:[{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.login,value:"login",placeholder:"Select Status",singleRule:!0,options:[{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.loggedin,value:"loggedin"},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.loggedout,value:"loggedout"}]},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.role,value:"role",multiple:!0,placeholder:"Select Roles",options:Object.entries(this.$aioseo.user.roles).map(e=>({label:e[1],value:e[0]}))},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.referrer,value:"referrer",regex:!0,singleRule:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.agent,value:"agent",regex:!0,taggable:!0,multiple:!0,options:[{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.mobile,value:"mobile",docLink:this.$links.getDocLink("Learn more","redirectCustomRulesUserAgent",!0)},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.feeds,value:"feeds",docLink:this.$links.getDocLink("Learn more","redirectCustomRulesUserAgent",!0)},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.libraries,value:"libraries",docLink:this.$links.getDocLink("Learn more","redirectCustomRulesUserAgent",!0)}]},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.cookie,value:"cookie",keyValuePair:!0,regex:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.ip,value:"ip",placeholder:"Enter an IP Address",taggable:!0,regex:!0,singleRule:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.server,value:"server",placeholder:"Enter the Server Name",regex:!0,singleRule:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.header,value:"header",keyValuePair:!0,regex:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.wp_filter,value:"wp_filter",placeholder:"Enter a WordPress Filter Name",taggable:!0},{label:this.$constants.REDIRECTS_CUSTOM_RULES_LABELS.locale,value:"locale",taggable:!0,regex:!0,placeholder:"Enter a Locale Code, e.g.: en_GB, es_ES",singleRule:!0}]}},computed:{hasCustomRules(){return 0<this.customRules.length},filteredTypes(){return this.types.map(e=>(e.$isDisabled=!1,e.singleRule&&this.customRules.find(s=>e.value===s.type)&&(e.$isDisabled=!0),e))}},methods:{removeRule(e){this.$delete(this.customRules,e),this.hasCustomRules||this.addRule(null)},addRule(e,s=!1){e||(e=JSON.parse(JSON.stringify(Ie))),(!s||s&&this.customRules.filter(t=>t===e).length===0)&&this.customRules.push(e)},updateRule(e,s,t){const r=this.customRules[t];s=typeof s.value!="undefined"?s.value:s,s=typeof s=="object"&&s.length?s.map(a=>a.value):s,r[e]=s,e==="type"&&(r.value=""),this.$set(this.customRules,t,r)},getRuleValue(e,s,t=!1){if(!this.customRules[s])return;let a=this.customRules[s][e],i=null;if(t)return a;switch(e){case"type":a=this.types.find(l=>a===l.value);break;case"value":i=this.getType(s,"options"),i&&(typeof a=="object"?a=a.map(l=>i.find(u=>l===u.value)||l).filter(l=>!!l):a=i.find(l=>a===l.value)||a),this.getType(s,"taggable")&&(a=typeof a=="object"?a.map(l=>typeof l.label=="undefined"?{label:l,value:l}:l):[]);break}return a},getType(e,s){const t=this.getRuleValue("type",e);return s?t&&typeof t[s]!="undefined"?t[s]:!1:t}},mounted(){this.editCustomRules&&(this.customRules=this.editCustomRules),this.hasCustomRules||this.addRule(null)}},U={};var Me=o(Ne,Pe,Oe,!1,Fe,"6dcc9dfa",null,null);function Fe(e){for(let s in U)this[s]=U[s]}var Be=function(){return Me.exports}(),qe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("svg",{staticClass:"aioseo-right-arrow",attrs:{width:"36",height:"16",viewBox:"0 0 36 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M36 8L28.4211 0.5V6.125H0V9.875H28.4211V15.5L36 8Z",fill:"currentColor"}})])},je=[];const He={},k={};var Ve=o(He,qe,je,!1,ze,null,null,null);function ze(e){for(let s in k)this[s]=k[s]}var We=function(){return Ve.exports}(),Ye=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-add-redirection",class:{"edit-url":e.edit,"log-404":e.log404}},[e.genericError?t("core-alert",{staticClass:"generic-error",attrs:{type:"red"}},[e._v(" "+e._s(e.strings.genericErrorMessage)+" ")]):e._e(),t("div",{staticClass:"urls"},[t("div",{staticClass:"source"},[t("div",{staticClass:"aioseo-settings-row no-border no-margin small-padding"},[t("div",{staticClass:"settings-name"},[t("div",{staticClass:"name small-margin"},[e._v(" "+e._s(e.sourceUrl)+": ")])]),e._l(e.sourceUrls,function(r,a){return t("core-add-redirection-url",{key:a,attrs:{url:r,"allow-delete":1<e.sourceUrls.length,"target-url":e.targetUrl,log404:e.log404,disableSource:e.disableSource},on:{"remove-url":function(i){return e.removeUrl(a)}},scopedSlots:e._u([e.edit&&!e.disableSource?{key:"source-url-description",fn:function(){return[t("div",{staticClass:"aioseo-description source-description",domProps:{innerHTML:e._s(e.strings.sourceUrlDescription)}})]},proxy:!0}:null],null,!0)})}),!e.edit&&!e.log404&&!e.disableSource?t("base-button",{attrs:{size:"small",type:"gray"},on:{click:e.addUrl}},[e._v(" "+e._s(e.strings.addUrl)+" ")]):e._e()],2)]),e.redirectTypeHasTarget()?t("div",{staticClass:"url-arrow"},[t("svg-right-arrow")],1):e._e(),e.redirectTypeHasTarget()?t("div",{staticClass:"target"},[t("div",{staticClass:"aioseo-settings-row no-border no-margin small-padding"},[t("div",{staticClass:"settings-name"},[t("div",{staticClass:"name small-margin"},[e._v(" "+e._s(e.strings.targetUrl)+": ")])]),t("div",{staticClass:"url"},[t("core-add-redirection-target-url",{attrs:{url:e.targetUrl,errors:e.targetUrlErrors,warnings:e.targetUrlWarnings},on:{input:e.updateTargetUrl}}),t("div",{staticClass:"aioseo-description"},[e._v(" "+e._s(e.strings.targetUrlDescription)+" ")]),t("transition-slide",{attrs:{active:!!e.targetUrlErrors.length}},[t("div",e._l(e.targetUrlErrors,function(r,a){return t("core-alert",{key:a,staticClass:"target-url-error",attrs:{type:"red",size:"small"},domProps:{innerHTML:e._s(r)}})}),1)]),t("transition-slide",{attrs:{active:!!e.targetUrlWarnings.length}},[t("div",e._l(e.targetUrlWarnings,function(r,a){return t("core-alert",{key:a,staticClass:"target-url-warning",attrs:{type:"yellow",size:"small"},domProps:{innerHTML:e._s(r)}})}),1)])],1)])]):e._e(),!e.edit&&!e.log404&&!e.disableSource?[t("div",{staticClass:"break"}),t("div",{staticClass:"source"},[t("div",{staticClass:"aioseo-description source-description",domProps:{innerHTML:e._s(e.strings.sourceUrlDescription)}})]),t("div",{staticClass:"url-arrow"}),t("div",{staticClass:"target"})]:e._e()],2),t("div",{staticClass:"settings",class:{advanced:e.showAdvancedSettings}},[t("div",{staticClass:"all-settings"},[t("div",{staticClass:"all-settings-content"},[t("div",{staticClass:"redirect-type"},[e._v(" "+e._s(e.strings.redirectType)+" "),t("base-select",{attrs:{options:e.$constants.REDIRECT_TYPES,size:"medium"},model:{value:e.redirectType,callback:function(r){e.redirectType=r},expression:"redirectType"}})],1),t("transition-slide",{staticClass:"advanced-settings",attrs:{active:e.showAdvancedSettings}},[t("div",{staticClass:"query-params"},[e._v(" "+e._s(e.strings.queryParams)+" "),t("base-select",{attrs:{options:e.redirectQueryParams,size:"medium"},model:{value:e.queryParam,callback:function(r){e.queryParam=r},expression:"queryParam"}})],1)]),e.showAdvancedSettings?e._e():t("a",{staticClass:"advanced-settings-link",attrs:{href:"#"},on:{click:function(r){r.preventDefault(),e.showAdvancedSettings=!e.showAdvancedSettings}}},[e._v(e._s(e.strings.advancedSettings))])],1)]),t("transition-slide",{staticClass:"advanced-settings",attrs:{active:e.showAdvancedSettings}},[t("custom-rules",{attrs:{"edit-custom-rules":e.customRules}})],1),t("div",{staticClass:"actions",class:{advanced:e.showAdvancedSettings}},[t("base-button",{attrs:{size:"medium",type:"blue",loading:e.addingRedirect,disabled:e.saveIsDisabled},on:{click:function(r){e.edit?e.saveChanges():e.addRedirects()}}},[e._v(" "+e._s(e.edit?e.strings.saveChanges:e.addRedirect)+" ")]),e.edit?t("base-button",{staticClass:"cancel-edit-row",attrs:{size:"medium",type:"gray"},on:{click:function(r){return e.$emit("cancel",!0)}}},[e._v(" "+e._s(e.strings.cancel)+" ")]):e._e()],1)],1)],1)},Ge=[];const Qe={components:{CoreAddRedirectionTargetUrl:Te,CoreAddRedirectionUrl:De,CoreAlert:_,CustomRules:Be,SvgRightArrow:We,TransitionSlide:m},mixins:[j],props:{edit:Boolean,log404:Boolean,disableSource:Boolean,url:Object,urls:Array,target:String,type:Number,query:String,slash:Boolean,case:Boolean,rules:{type:Array,default(){return[]}}},data(){return{genericError:!1,showAdvancedSettings:!1,addingRedirect:!1,targetUrl:null,targetUrlErrors:[],targetUrlWarnings:[],sourceUrls:[],redirectType:null,queryParam:null,customRules:[],strings:{redirectType:"Redirect Type:",targetUrl:"Target URL",targetUrlDescription:"Enter a URL or start by typing a page or post title, slug or ID.",addUrl:"Add URL",sourceUrlDescription:this.$t.sprintf("Enter a relative URL to redirect from or start by typing in page or post title, slug or ID. You can also use regex (%1$s)",this.$links.getDocLink("what's this?","redirectManagerRegex")),advancedSettings:"Advanced Settings",queryParams:"Query Parameters:",saveChanges:"Save Changes",cancel:"Cancel",genericErrorMessage:"An error occurred while adding your redirects. Please try again later."}}},watch:{sourceUrls:{deep:!0,handler(){g(()=>this.checkForDuplicates(),500)}}},computed:c(n({},d("redirects",["options"])),{saveIsDisabled(){return!!this.sourceUrls.filter(e=>!e.url).length||!!this.sourceUrls.filter(e=>0<e.errors.length).length||this.redirectTypeHasTarget()&&!this.targetUrl},getRelativeAbsolute(){const e=this.targetUrl.match(/^\/([a-zA-Z0-9_\-%]*\..*)\//);return e?e[0]:null},sourceUrl(){return 1<this.sourceUrls.length?"Source URL's":"Source URL"},addRedirect(){return 1<this.sourceUrls.length?"Add Redirects":"Add Redirect"},hasTargetUrlErrors(){if(!this.targetUrl)return[];const e=[];this.targetUrl&&!this.beginsWith(this.targetUrl,"https://")&&!this.beginsWith(this.targetUrl,"http://")&&this.targetUrl.substr(0,1)!=="/"&&e.push(this.$t.sprintf("Your target URL should be an absolute URL like %1$s or start with a slash.","<code>https://domain.com/"+this.targetUrl+"</code>","<code>/"+this.targetUrl+"</code>"));const s=this.targetUrl.match(/[|\\$]/g);return s!==null&&(this.sourceUrls.map(r=>r.regex).every(r=>r)||e.push(this.$t.sprintf("Your target URL contains the invalid character(s) %1$s","<code>"+s+"</code>"))),e},hasTargetUrlWarnings(){if(!this.targetUrl)return[];const e=[];return this.getRelativeAbsolute&&e.push(this.$t.sprintf("Your URL appears to contain a domain inside the path: %1$s. Did you mean to use %2$s instead?","<code>"+this.getRelativeAbsolute+"</code>","<code>https:/"+this.getRelativeAbsolute+"</code>")),e},getDefaultRedirectType(){let e=this.getJsonValue(this.options.redirectDefaults.redirectType);return e||(e=this.$constants.REDIRECT_TYPES[0]),e},getDefaultQueryParam(){let e=this.getJsonValue(this.options.redirectDefaults.queryParam);return e||(e=this.$constants.REDIRECT_QUERY_PARAMS[0]),e},getDefaultSlash(){return this.options.redirectDefaults.ignoreSlash},getDefaultCase(){return this.options.redirectDefaults.ignoreCase},getDefaultSourceUrls(){return[JSON.parse(JSON.stringify(this.getDefaultSourceUrl))]},getDefaultSourceUrl(){return{id:null,url:null,regex:!1,ignoreSlash:this.slash||this.getDefaultSlash||!1,ignoreCase:this.case||this.getDefaultCase||!1,errors:[],warnings:[]}},redirectQueryParams(){return 0<this.sourceUrls.filter(e=>e.regex).length?this.$constants.REDIRECT_QUERY_PARAMS.map(e=>(e.$isDisabled=!1,e.value==="exact"&&(e.$isDisabled=!0,this.queryParam.value==="exact"&&(this.queryParam=this.$constants.REDIRECT_QUERY_PARAMS.find(s=>!s.$isDisabled))),e)):this.$constants.REDIRECT_QUERY_PARAMS.map(e=>(e.$isDisabled=!1,e))}}),methods:c(n({},h("redirects",["create","update"])),{beginsWith(e,s){return s.indexOf(e)===0||e.substr(0,s.length)===s},addUrl(){this.sourceUrls.push(JSON.parse(JSON.stringify(this.getDefaultSourceUrl)))},removeUrl(e){this.$delete(this.sourceUrls,e)},addRedirects(){this.genericError=!1,this.addingRedirect=!0,this.sourceUrls.map(e=>(e.url.substr(0,4)!=="http"&&e.url.substr(0,1)!=="/"&&0<e.url.length&&!e.regex&&(e.url="/"+e.url),e)),this.create({sourceUrls:this.sourceUrls,targetUrl:this.targetUrl,queryParam:this.queryParam.value,customRules:this.customRules,redirectType:this.redirectType.value,redirectTypeHasTarget:this.redirectTypeHasTarget(),group:this.log404?"404":"manual"}).then(()=>{this.$emit("added-redirect"),this.$bus.$emit("added-redirect"),this.reset()}).catch(e=>{this.handleError(e)})},saveChanges(){this.genericError=!1,this.addingRedirect=!0,this.sourceUrls[0].url.substr(0,4)!=="http"&&this.sourceUrls[0].url.substr(0,1)!=="/"&&0<this.sourceUrls[0].url.length&&!this.sourceUrls[0].regex&&(this.sourceUrls[0].url="/"+this.sourceUrls[0].url),this.update({id:this.sourceUrls[0].id,payload:{sourceUrls:this.sourceUrls,targetUrl:this.targetUrl,queryParam:this.queryParam.value,customRules:this.customRules,redirectType:this.redirectType.value,redirectTypeHasTarget:this.redirectTypeHasTarget()}}).then(()=>{this.reset()}).catch(e=>{console.error(e),this.handleError(e)})},handleError(e){if(e.response.status!==409||!e.response.body.failed||!e.response.body.failed.length){this.genericError=!0,this.addingRedirect=!1;return}const s=[],t=e.response.body.failed,r="A redirect already exists for this source URL. To make changes, edit the original instead.";t.forEach(a=>{const i=this.sourceUrls.findIndex(l=>l.url===a.url||a);i!==-1&&(this.sourceUrls[i].errors.find(l=>l===a.error||l===r)||this.sourceUrls[i].errors.push(a.error||r),s.push(i))});for(let a=this.sourceUrls.length-1;0<=a;a--)s.includes(a)||this.$delete(this.sourceUrls,a);this.addingRedirect=!1},updateTargetUrl(e){this.targetUrl=e,this.targetUrlErrors=this.hasTargetUrlErrors,this.targetUrlWarnings=this.hasTargetUrlWarnings},reset(){if(this.showAdvancedSettings=!1,this.addingRedirect=!1,this.edit)return;const e=this.$constants.REDIRECT_TYPES.find(t=>t.value===this.type),s=this.$constants.REDIRECT_QUERY_PARAMS.find(t=>t.value===this.query);this.sourceUrls=[JSON.parse(JSON.stringify(this.getDefaultSourceUrl))],this.targetUrl=null,this.targetUrlErrors=[],this.targetUrlWarnings=[],this.redirectType=e||{label:"301 Moved Permanently",value:301},this.queryParam=s||{label:"Ignore all parameters",value:"ignore"},this.customRules=[]},checkForDuplicates(){const e=[];this.sourceUrls.forEach((s,t)=>{if(!(!s.url||s.errors.length)){if(e.includes(s.url.replace(/\/$/,""))){this.sourceUrls[t].errors.push("This is a duplicate of a URL you are already adding. You can only add unique source URL's.");return}e.push(s.url.replace(/\/$/,""))}}),this.updateTargetUrl(this.targetUrl)},redirectTypeHasTarget(){return this.redirectType&&(typeof this.redirectType.noTarget=="undefined"||!this.redirectType.noTarget)}}),mounted(){this.sourceUrls=this.getDefaultSourceUrls,this.url&&(this.sourceUrls=[n(n({},this.getDefaultSourceUrl),this.url)]),this.urls&&this.urls.length&&(this.sourceUrls=this.urls.map(t=>n(n({},this.getDefaultSourceUrl),t))),this.target&&(this.targetUrl=this.target),this.rules&&(this.customRules=this.rules);const e=this.$constants.REDIRECT_TYPES.find(t=>t.value===this.type)||this.getDefaultRedirectType;e&&(this.redirectType=e);const s=this.$constants.REDIRECT_QUERY_PARAMS.find(t=>t.value===this.query)||this.getDefaultQueryParam;s&&(this.queryParam=s)}},T={};var Je=o(Qe,Ye,Ge,!1,Ke,null,null,null);function Ke(e){for(let s in T)this[s]=T[s]}var Ze=function(){return Je.exports}(),Xe=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-redirects-blur"},[e.noCoreCard?e._e():t("core-card",{attrs:{slug:"addNewRedirection","header-text":e.strings.addNewRedirection,noSlide:!0}},[t("core-blur",[t("core-add-redirection",{attrs:{type:e.$constants.REDIRECT_TYPES[0].value,query:e.$constants.REDIRECT_QUERY_PARAMS[0].value,slash:!0,case:!0}})],1)],1),e.noCoreCard?t("core-blur",[t("core-add-redirection",{attrs:{type:e.$constants.REDIRECT_TYPES[0].value,query:e.$constants.REDIRECT_QUERY_PARAMS[0].value,slash:!0,case:!0}})],1):e._e(),t("core-blur",[t("core-wp-table",{attrs:{filters:[],totals:{total:0,pages:0,page:1},columns:e.columns,rows:[],"search-label":e.strings.searchUrls,"bulk-options":e.bulkOptions,"additional-filters":e.additionalFilters}})],1)],1)},et=[];const tt={components:{CoreAddRedirection:Ze,CoreBlur:J,CoreCard:K,CoreWpTable:me},props:{noCoreCard:Boolean},data(){return{strings:{addNewRedirection:"Add New Redirection",searchUrls:"Search URLs"},bulkOptions:[{label:"",value:""}]}},computed:{columns(){return[{slug:"source_url",label:"Source URL"},{slug:"target_url",label:"Target URL"},{slug:"hits",label:"Hits",width:"97px"},{slug:"type",label:"Type",width:"100px"},{slug:"group",label:"Group",width:"150px"},{slug:"enabled",label:this.$constants.GLOBAL_STRINGS.enabled,width:"80px"}]},additionalFilters(){return[{label:"Filter by Group",name:"group",options:[{label:"All Groups",value:"all"}].concat(this.$constants.REDIRECT_GROUPS)}]}}},E={};var st=o(tt,Xe,et,!1,rt,null,null,null);function rt(e){for(let s in E)this[s]=E[s]}var at=function(){return st.exports}(),it=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"aioseo-redirects"},[t("blur",{attrs:{noCoreCard:e.noCoreCard}}),t("cta",{attrs:{"cta-link":e.$links.getPricingUrl("redirects","redirects-upsell",e.parentComponentContext?e.parentComponentContext:null),"button-text":e.strings.ctaButtonText,"learn-more-link":e.$links.getUpsellUrl("redirects",e.parentComponentContext?e.parentComponentContext:null,"home"),"feature-list":[e.strings.serverRedirects,e.strings.automaticRedirects,e.strings.redirectMonitoring,e.strings.monitoring404,e.strings.fullSiteRedirects,e.strings.siteAliases]},scopedSlots:e._u([{key:"header-text",fn:function(){return[e._v(" "+e._s(e.strings.ctaHeader)+" ")]},proxy:!0},{key:"description",fn:function(){return[e.$isPro&&e.$addons.requiresUpgrade("aioseo-redirects")&&e.$addons.currentPlans("aioseo-redirects")?t("core-alert",{attrs:{type:"red"}},[e._v(" "+e._s(e.strings.thisFeatureRequires)+" "),t("strong",[e._v(e._s(e.$addons.currentPlans("aioseo-redirects")))])]):e._e(),e.$isPro&&e.$addons.isActive("aioseo-redirects")&&!e.$addons.hasMinimumVersion("aioseo-redirects")?t("core-alert",[e._v(" CHANGEME ")]):e._e(),e._v(" "+e._s(e.strings.redirectsDescription)+" ")]},proxy:!0}])})],1)},lt=[];const nt={components:{Blur:at,CoreAlert:_,Cta:Z},props:{hasMinimumVersion:Boolean,noCoreCard:Boolean,parentComponentContext:String},data(){return{strings:{ctaButtonText:"Upgrade to Pro and Unlock Redirects",ctaHeader:this.$t.sprintf("Redirects are only available for licensed %1$s %2$s users.","AIOSEO","Pro"),serverRedirects:"Fast Server Redirects",automaticRedirects:"Automatic Redirects",redirectMonitoring:"Redirect Monitoring",monitoring404:"404 Monitoring",fullSiteRedirects:"Full Site Redirects",siteAliases:"Site Aliases",redirectsDescription:"Our Redirection Manager allows you to easily create and manage redirects for your broken links to avoid confusing search engines and users, as well as losing valuable backlinks. It even automatically sends users and search engines from your old URLs to your new ones.",thisFeatureRequires:"This feature requires one of the following plans:"}}}},w={};var ot=o(nt,it,lt,!1,ut,null,null,null);function ut(e){for(let s in w)this[s]=w[s]}var xt=function(){return ot.exports}();export{at as B,me as C,xt as R,Ze as a};
